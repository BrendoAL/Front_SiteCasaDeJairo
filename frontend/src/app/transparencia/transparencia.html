<main class="container">
  <h1>Transparência</h1>
  <p>
    Acompanhe como utilizamos os recursos da ONG Casa de Jairo.
    Nosso compromisso é com a <strong>clareza e a confiança</strong>!
  </p>

  <section id="transparencia-lista" *ngIf="posts.length > 0; else semPosts">
    <h2>Relatórios e Publicações</h2>

    <div class="transparencia-cards">
      <div class="card" *ngFor="let post of posts">
        <!-- Imagem -->
        <img *ngIf="post.postImagemId" 
             [src]="getImagem(post.postImagemId)" 
             alt="Imagem do post" 
             class="card-img" 
             (error)="onImageError($event)" />

        <div class="card-body">
          <h3>{{ post.titulo }}</h3>
          <small class="data">{{ post.data | date:'dd/MM/yyyy' }}</small>

          <p>
            {{ post.descricao.length > 200 ? (post.descricao | slice:0:200) + '...' : post.descricao }}
          </p>

          <button class="btn-detalhes" (click)="abrirModal(post)">Ler mais</button>
        </div>
      </div>
    </div>
  </section>

  <ng-template #semPosts>
    <p style="text-align:center; margin-top: 20px; color: #666;">
      Nenhum registro de transparência disponível no momento.
    </p>
  </ng-template>
</main>

<!-- Modal -->
<div class="modal-backdrop" 
     *ngIf="modalAberto" 
     (click)="fecharModalBackdrop($event)">
  
  <div class="modal-content">
    <div class="modal-header">
      <h2>{{ postSelecionado?.titulo }}</h2>
      <button class="modal-close" (click)="fecharModal()">&times;</button>
    </div>

    <div class="modal-body">
      <!-- Imagem no modal -->
      <img *ngIf="postSelecionado?.postImagemId" 
           [src]="getImagem(postSelecionado?.postImagemId)" 
           alt="Imagem do post" 
           class="modal-img"
           (error)="onImageError($event)" />

      <div class="modal-info">
        <small class="data">{{ postSelecionado?.data | date:'dd/MM/yyyy' }}</small>
        <p class="modal-description">{{ postSelecionado?.descricao }}</p>
      </div>
    </div>

    <div class="modal-footer">
      <button class="btn-fechar" (click)="fecharModal()">Fechar</button>
    </div>
  </div>
</div>