<!-- CONTEÚDO -->
<main>
    <section class="box-visao-geral">
        <div class="box-visao-geral-titulo container">
            <br>
            <h1 class="titulo-centro">Notícias e Eventos</h1>
            <p class="p-centro">Confira os últimos acontecimentos e ações realizadas pela Casa de Jairo.</p>
        </div>
    </section>

    <!-- CARROSSEL CONTROLÁVEL -->
<section class="carrossel-eventos">
  <div class="carrossel-container">
    <div class="carrossel-slides">
      <div *ngFor="let imagem of imagens; let i = index" 
           class="slide" 
           [class.active]="i === currentSlideIndex">
        <img [src]="imagem.src" [alt]="imagem.alt">
        <div class="slide-title">
          <h3>{{imagem.title}}</h3>
        </div>
      </div>
    </div>
    
    <!-- Botões de navegação -->
    <button class="nav-btn prev-btn" (click)="prevSlide()" aria-label="Anterior">❮</button>
    <button class="nav-btn next-btn" (click)="nextSlide()" aria-label="Próximo">❯</button>
    
    <!-- Indicadores -->
    <div class="indicators">
      <button *ngFor="let imagem of imagens; let i = index"
              class="indicator"
              [class.active]="i === currentSlideIndex"
              (click)="goToSlide(i)"
              [attr.aria-label]="'Ir para slide ' + (i + 1)">
      </button>
    </div>
  </div>
</section>

    <!-- NOTÍCIAS (GRID) -->
    <section class="secao">
        <div class="container">
            <h2 class="titulo-centro"><i class="fa-regular fa-newspaper"></i> Últimas Notícias</h2>

            <!-- Mensagem quando não há eventos -->
            <div *ngIf="eventos.length === 0" class="no-eventos">
                <p>Nenhum evento cadastrado no momento.</p>
            </div>

            <!-- Grid de eventos -->
            <div *ngIf="eventos.length > 0" class="eventos-container">
                <article *ngFor="let e of eventos" class="evento-card">
                    <figure class="thumb">
                        <img 
                            [src]="getImageUrl(e)" 
                            [alt]="e.titulo" 
                            loading="lazy"
                            (error)="onImageError($event)">
                    </figure>
                    <div class="conteudo">
                        <small>{{ e.data | date:'dd/MM/yyyy' }}</small>
                        <h3>{{ e.titulo }}</h3>
                        <p>{{ truncateDescription(e.descricao, 100) }}</p>
                        <button class="button-amarelo" (click)="abrirPopup(e)">Leia mais</button>
                    </div>
                </article>
            </div>

        </div>
    </section>

    <!-- POPUP MODAL -->
    <div *ngIf="eventoSelecionado" class="popup-overlay" (click)="fecharPopup()">
        <div class="popup-content" (click)="$event.stopPropagation()">
            <button class="popup-close" (click)="fecharPopup()">&times;</button>
            
            <div class="popup-header">
                <img 
                    [src]="getImageUrl(eventoSelecionado)" 
                    [alt]="eventoSelecionado.titulo"
                    class="popup-image">
            </div>
            
            <div class="popup-body">
                <small class="popup-date">{{ eventoSelecionado.data | date:'dd/MM/yyyy' }}</small>
                <h2>{{ eventoSelecionado.titulo }}</h2>
                <p class="popup-local">
                    <i class="fa fa-map-marker"></i> {{ eventoSelecionado.local }}
                </p>
                <div class="popup-description">
                    {{ eventoSelecionado.descricao }}
                </div>
            </div>
        </div>
    </div>
</main>
